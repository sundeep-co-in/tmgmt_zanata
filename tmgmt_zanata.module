<?php

/**
 * @file
 * Module file for translation management Zanata module.
 *
 * http://zanata.org/
 *
 * Implemented by David Mason damason@redhat.com
 */

/**
 * Implements hook_tmgmt_translator_plugin_info()
 */
function tmgmt_zanata_tmgmt_translator_plugin_info() {
  return array(
    'zanata' => array(
      'label' => t('Zanata translator'),
      'description' => t('Service to translate strings with Zanata'),
      'plugin controller class' => 'TMGMTZanataTranslatorPluginController',
      'ui controller class' => 'TMGMTZanataTranslatorUIController',
      'auto create' => TRUE, // FIXME make sure auto create works properly
      'default settings' => array(
        'server' => 'http://localhost:8080/zanata',
      ),
      // TODO look at other settings on the hook page
    ),
  );
}

function tmgmt_zanata_resubmit_translations($form, &$form_state) {
  $job = $form_state['tmgmt_job'];
  $job->getTranslatorController()->resubmitTranslation($job);
}

/**
 * Callback used to poll for translations in the UI checkoutInfo form
 */
function tmgmt_zanata_poll_translations($form, &$form_state) {
  $job = $form_state['tmgmt_job'];
  $job->getTranslatorController()->getConnector($job)->pollTranslations();
}
